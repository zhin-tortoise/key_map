   1               		.file	"ssd1306.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text._send_cmd1,"ax",@progbits
  12               	_send_cmd1:
  13               	.LFB113:
  14               		.file 1 "keyboards/lily58/ssd1306.c"
   1:keyboards/lily58/ssd1306.c **** #ifdef SSD1306OLED
   2:keyboards/lily58/ssd1306.c **** 
   3:keyboards/lily58/ssd1306.c **** #include "ssd1306.h"
   4:keyboards/lily58/ssd1306.c **** #include "i2c.h"
   5:keyboards/lily58/ssd1306.c **** #include <string.h>
   6:keyboards/lily58/ssd1306.c **** #include "print.h"
   7:keyboards/lily58/ssd1306.c **** #ifdef ADAFRUIT_BLE_ENABLE
   8:keyboards/lily58/ssd1306.c **** #include "adafruit_ble.h"
   9:keyboards/lily58/ssd1306.c **** #endif
  10:keyboards/lily58/ssd1306.c **** #ifdef PROTOCOL_LUFA
  11:keyboards/lily58/ssd1306.c **** #include "lufa.h"
  12:keyboards/lily58/ssd1306.c **** #endif
  13:keyboards/lily58/ssd1306.c **** #include "sendchar.h"
  14:keyboards/lily58/ssd1306.c **** #include "timer.h"
  15:keyboards/lily58/ssd1306.c **** 
  16:keyboards/lily58/ssd1306.c **** static const unsigned char font[] PROGMEM;
  17:keyboards/lily58/ssd1306.c **** 
  18:keyboards/lily58/ssd1306.c **** // Set this to 1 to help diagnose early startup problems
  19:keyboards/lily58/ssd1306.c **** // when testing power-on with ble.  Turn it off otherwise,
  20:keyboards/lily58/ssd1306.c **** // as the latency of printing most of the debug info messes
  21:keyboards/lily58/ssd1306.c **** // with the matrix scan, causing keys to drop.
  22:keyboards/lily58/ssd1306.c **** #define DEBUG_TO_SCREEN 0
  23:keyboards/lily58/ssd1306.c **** 
  24:keyboards/lily58/ssd1306.c **** //static uint16_t last_battery_update;
  25:keyboards/lily58/ssd1306.c **** //static uint32_t vbat;
  26:keyboards/lily58/ssd1306.c **** //#define BatteryUpdateInterval 10000 /* milliseconds */
  27:keyboards/lily58/ssd1306.c **** 
  28:keyboards/lily58/ssd1306.c **** // 'last_flush' is declared as uint16_t,
  29:keyboards/lily58/ssd1306.c **** // so this must be less than 65535 
  30:keyboards/lily58/ssd1306.c **** #define ScreenOffInterval 60000 /* milliseconds */
  31:keyboards/lily58/ssd1306.c **** #if DEBUG_TO_SCREEN
  32:keyboards/lily58/ssd1306.c **** static uint8_t displaying;
  33:keyboards/lily58/ssd1306.c **** #endif
  34:keyboards/lily58/ssd1306.c **** static uint16_t last_flush;
  35:keyboards/lily58/ssd1306.c **** 
  36:keyboards/lily58/ssd1306.c **** static bool force_dirty = true;
  37:keyboards/lily58/ssd1306.c **** 
  38:keyboards/lily58/ssd1306.c **** // Write command sequence.
  39:keyboards/lily58/ssd1306.c **** // Returns true on success.
  40:keyboards/lily58/ssd1306.c **** static inline bool _send_cmd1(uint8_t cmd) {
  15               		.loc 1 40 0
  16               		.cfi_startproc
  17               	.LVL0:
  18 0000 CF93      		push r28
  19               	.LCFI0:
  20               		.cfi_def_cfa_offset 3
  21               		.cfi_offset 28, -2
  22               	/* prologue: function */
  23               	/* frame size = 0 */
  24               	/* stack size = 1 */
  25               	.L__stack_usage = 1
  26 0002 C82F      		mov r28,r24
  27               	.LVL1:
  28               	.LBB4:
  29               	.LBB5:
  30               		.file 2 "keyboards/lily58/i2c.h"
   1:keyboards/lily58/i2c.h **** #pragma once
   2:keyboards/lily58/i2c.h **** 
   3:keyboards/lily58/i2c.h **** #include <stdint.h>
   4:keyboards/lily58/i2c.h **** 
   5:keyboards/lily58/i2c.h **** #ifndef F_CPU
   6:keyboards/lily58/i2c.h **** #define F_CPU 16000000UL
   7:keyboards/lily58/i2c.h **** #endif
   8:keyboards/lily58/i2c.h **** 
   9:keyboards/lily58/i2c.h **** #define I2C_READ 1
  10:keyboards/lily58/i2c.h **** #define I2C_WRITE 0
  11:keyboards/lily58/i2c.h **** 
  12:keyboards/lily58/i2c.h **** #define I2C_ACK 1
  13:keyboards/lily58/i2c.h **** #define I2C_NACK 0
  14:keyboards/lily58/i2c.h **** 
  15:keyboards/lily58/i2c.h **** #define SLAVE_BUFFER_SIZE 0x10
  16:keyboards/lily58/i2c.h **** 
  17:keyboards/lily58/i2c.h **** // i2c SCL clock frequency 400kHz
  18:keyboards/lily58/i2c.h **** #define SCL_CLOCK  400000L
  19:keyboards/lily58/i2c.h **** 
  20:keyboards/lily58/i2c.h **** extern volatile uint8_t i2c_slave_buffer[SLAVE_BUFFER_SIZE];
  21:keyboards/lily58/i2c.h **** 
  22:keyboards/lily58/i2c.h **** void i2c_master_init(void);
  23:keyboards/lily58/i2c.h **** uint8_t i2c_master_start(uint8_t address);
  24:keyboards/lily58/i2c.h **** void i2c_master_stop(void);
  25:keyboards/lily58/i2c.h **** uint8_t i2c_master_write(uint8_t data);
  26:keyboards/lily58/i2c.h **** uint8_t i2c_master_read(int);
  27:keyboards/lily58/i2c.h **** void i2c_reset_state(void);
  28:keyboards/lily58/i2c.h **** void i2c_slave_init(uint8_t address);
  29:keyboards/lily58/i2c.h **** 
  30:keyboards/lily58/i2c.h **** 
  31:keyboards/lily58/i2c.h **** static inline unsigned char i2c_start_read(unsigned char addr) {
  32:keyboards/lily58/i2c.h ****   return i2c_master_start((addr << 1) | I2C_READ);
  33:keyboards/lily58/i2c.h **** }
  34:keyboards/lily58/i2c.h **** 
  35:keyboards/lily58/i2c.h **** static inline unsigned char i2c_start_write(unsigned char addr) {
  36:keyboards/lily58/i2c.h ****   return i2c_master_start((addr << 1) | I2C_WRITE);
  31               		.loc 2 36 0
  32 0004 88E7      		ldi r24,lo8(120)
  33               	.LVL2:
  34 0006 0E94 0000 		call i2c_master_start
  35               	.LVL3:
  36               	.LBE5:
  37               	.LBE4:
  41:keyboards/lily58/ssd1306.c ****   bool res = false;
  42:keyboards/lily58/ssd1306.c **** 
  43:keyboards/lily58/ssd1306.c ****   if (i2c_start_write(SSD1306_ADDRESS)) {
  38               		.loc 1 43 0
  39 000a 8111      		cpse r24,__zero_reg__
  40 000c 00C0      		rjmp .L9
  44:keyboards/lily58/ssd1306.c ****     xprintf("failed to start write to %d\n", SSD1306_ADDRESS);
  45:keyboards/lily58/ssd1306.c ****     goto done;
  46:keyboards/lily58/ssd1306.c ****   }
  47:keyboards/lily58/ssd1306.c **** 
  48:keyboards/lily58/ssd1306.c ****   if (i2c_master_write(0x0 /* command byte follows */)) {
  41               		.loc 1 48 0
  42 000e 80E0      		ldi r24,0
  43 0010 0E94 0000 		call i2c_master_write
  44               	.LVL4:
  45 0014 8111      		cpse r24,__zero_reg__
  46 0016 00C0      		rjmp .L9
  49:keyboards/lily58/ssd1306.c ****     print("failed to write control byte\n");
  50:keyboards/lily58/ssd1306.c **** 
  51:keyboards/lily58/ssd1306.c ****     goto done;
  52:keyboards/lily58/ssd1306.c ****   }
  53:keyboards/lily58/ssd1306.c **** 
  54:keyboards/lily58/ssd1306.c ****   if (i2c_master_write(cmd)) {
  47               		.loc 1 54 0
  48 0018 8C2F      		mov r24,r28
  49 001a 0E94 0000 		call i2c_master_write
  50               	.LVL5:
  51 001e C1E0      		ldi r28,lo8(1)
  52               	.LVL6:
  53 0020 8111      		cpse r24,__zero_reg__
  54               	.L9:
  55 0022 C0E0      		ldi r28,0
  56               	.L3:
  57               	.LVL7:
  55:keyboards/lily58/ssd1306.c ****     xprintf("failed to write command %d\n", cmd);
  56:keyboards/lily58/ssd1306.c ****     goto done;
  57:keyboards/lily58/ssd1306.c ****   }
  58:keyboards/lily58/ssd1306.c ****   res = true;
  59:keyboards/lily58/ssd1306.c **** done:
  60:keyboards/lily58/ssd1306.c ****   i2c_master_stop();
  58               		.loc 1 60 0
  59 0024 0E94 0000 		call i2c_master_stop
  60               	.LVL8:
  61:keyboards/lily58/ssd1306.c ****   return res;
  62:keyboards/lily58/ssd1306.c **** }
  61               		.loc 1 62 0
  62 0028 8C2F      		mov r24,r28
  63               	/* epilogue start */
  64 002a CF91      		pop r28
  65               	.LVL9:
  66 002c 0895      		ret
  67               		.cfi_endproc
  68               	.LFE113:
  70               		.section	.text._send_cmd2,"ax",@progbits
  72               	_send_cmd2:
  73               	.LFB114:
  63:keyboards/lily58/ssd1306.c **** 
  64:keyboards/lily58/ssd1306.c **** // Write 2-byte command sequence.
  65:keyboards/lily58/ssd1306.c **** // Returns true on success
  66:keyboards/lily58/ssd1306.c **** static inline bool _send_cmd2(uint8_t cmd, uint8_t opr) {
  74               		.loc 1 66 0
  75               		.cfi_startproc
  76               	.LVL10:
  77 0000 CF93      		push r28
  78               	.LCFI1:
  79               		.cfi_def_cfa_offset 3
  80               		.cfi_offset 28, -2
  81 0002 DF93      		push r29
  82               	.LCFI2:
  83               		.cfi_def_cfa_offset 4
  84               		.cfi_offset 29, -3
  85 0004 1F92      		push __zero_reg__
  86               	.LCFI3:
  87               		.cfi_def_cfa_offset 5
  88 0006 CDB7      		in r28,__SP_L__
  89 0008 DEB7      		in r29,__SP_H__
  90               	.LCFI4:
  91               		.cfi_def_cfa_register 28
  92               	/* prologue: function */
  93               	/* frame size = 1 */
  94               	/* stack size = 3 */
  95               	.L__stack_usage = 3
  67:keyboards/lily58/ssd1306.c ****   if (!_send_cmd1(cmd)) {
  96               		.loc 1 67 0
  97 000a 6983      		std Y+1,r22
  98 000c 0E94 0000 		call _send_cmd1
  99               	.LVL11:
 100 0010 6981      		ldd r22,Y+1
 101 0012 8823      		tst r24
 102 0014 01F0      		breq .L12
  68:keyboards/lily58/ssd1306.c ****     return false;
  69:keyboards/lily58/ssd1306.c ****   }
  70:keyboards/lily58/ssd1306.c ****   return _send_cmd1(opr);
 103               		.loc 1 70 0
 104 0016 862F      		mov r24,r22
 105               	/* epilogue start */
  71:keyboards/lily58/ssd1306.c **** }
 106               		.loc 1 71 0
 107 0018 0F90      		pop __tmp_reg__
 108 001a DF91      		pop r29
 109 001c CF91      		pop r28
  70:keyboards/lily58/ssd1306.c **** }
 110               		.loc 1 70 0
 111 001e 0C94 0000 		jmp _send_cmd1
 112               	.LVL12:
 113               	.L12:
 114               		.loc 1 71 0
 115 0022 80E0      		ldi r24,0
 116               	/* epilogue start */
 117 0024 0F90      		pop __tmp_reg__
 118 0026 DF91      		pop r29
 119 0028 CF91      		pop r28
 120 002a 0895      		ret
 121               		.cfi_endproc
 122               	.LFE114:
 124               		.section	.text._send_cmd3.constprop.1,"ax",@progbits
 126               	_send_cmd3.constprop.1:
 127               	.LFB138:
  72:keyboards/lily58/ssd1306.c **** 
  73:keyboards/lily58/ssd1306.c **** // Write 3-byte command sequence.
  74:keyboards/lily58/ssd1306.c **** // Returns true on success
  75:keyboards/lily58/ssd1306.c **** static inline bool _send_cmd3(uint8_t cmd, uint8_t opr1, uint8_t opr2) {
 128               		.loc 1 75 0
 129               		.cfi_startproc
 130               	.LVL13:
 131 0000 CF93      		push r28
 132               	.LCFI5:
 133               		.cfi_def_cfa_offset 3
 134               		.cfi_offset 28, -2
 135               	/* prologue: function */
 136               	/* frame size = 0 */
 137               	/* stack size = 1 */
 138               	.L__stack_usage = 1
 139 0002 C62F      		mov r28,r22
 140               	.LVL14:
  76:keyboards/lily58/ssd1306.c ****   if (!_send_cmd1(cmd)) {
 141               		.loc 1 76 0
 142 0004 0E94 0000 		call _send_cmd1
 143               	.LVL15:
 144 0008 8823      		tst r24
 145 000a 01F0      		breq .L15
 146               	.LVL16:
 147               	.LBB8:
 148               	.LBB9:
  77:keyboards/lily58/ssd1306.c ****     return false;
  78:keyboards/lily58/ssd1306.c ****   }
  79:keyboards/lily58/ssd1306.c ****   if (!_send_cmd1(opr1)) {
 149               		.loc 1 79 0
 150 000c 80E0      		ldi r24,0
 151 000e 0E94 0000 		call _send_cmd1
 152               	.LVL17:
 153 0012 8823      		tst r24
 154 0014 01F0      		breq .L15
  80:keyboards/lily58/ssd1306.c ****     return false;
  81:keyboards/lily58/ssd1306.c ****   }
  82:keyboards/lily58/ssd1306.c ****   return _send_cmd1(opr2);
 155               		.loc 1 82 0
 156 0016 8C2F      		mov r24,r28
 157               	/* epilogue start */
 158               	.LBE9:
 159               	.LBE8:
  83:keyboards/lily58/ssd1306.c **** }
 160               		.loc 1 83 0
 161 0018 CF91      		pop r28
 162               	.LVL18:
 163               	.LBB11:
 164               	.LBB10:
  82:keyboards/lily58/ssd1306.c **** }
 165               		.loc 1 82 0
 166 001a 0C94 0000 		jmp _send_cmd1
 167               	.LVL19:
 168               	.L15:
 169               	.LBE10:
 170               	.LBE11:
 171               		.loc 1 83 0
 172 001e 80E0      		ldi r24,0
 173               	/* epilogue start */
 174 0020 CF91      		pop r28
 175               	.LVL20:
 176 0022 0895      		ret
 177               		.cfi_endproc
 178               	.LFE138:
 180               		.section	.text.iota_gfx_off,"ax",@progbits
 181               	.global	iota_gfx_off
 183               	iota_gfx_off:
 184               	.LFB118:
  84:keyboards/lily58/ssd1306.c **** 
  85:keyboards/lily58/ssd1306.c **** #define send_cmd1(c) if (!_send_cmd1(c)) {goto done;}
  86:keyboards/lily58/ssd1306.c **** #define send_cmd2(c,o) if (!_send_cmd2(c,o)) {goto done;}
  87:keyboards/lily58/ssd1306.c **** #define send_cmd3(c,o1,o2) if (!_send_cmd3(c,o1,o2)) {goto done;}
  88:keyboards/lily58/ssd1306.c **** 
  89:keyboards/lily58/ssd1306.c **** static void clear_display(void) {
  90:keyboards/lily58/ssd1306.c ****   matrix_clear(&display);
  91:keyboards/lily58/ssd1306.c **** 
  92:keyboards/lily58/ssd1306.c ****   // Clear all of the display bits (there can be random noise
  93:keyboards/lily58/ssd1306.c ****   // in the RAM on startup)
  94:keyboards/lily58/ssd1306.c ****   send_cmd3(PageAddr, 0, (DisplayHeight / 8) - 1);
  95:keyboards/lily58/ssd1306.c ****   send_cmd3(ColumnAddr, 0, DisplayWidth - 1);
  96:keyboards/lily58/ssd1306.c **** 
  97:keyboards/lily58/ssd1306.c ****   if (i2c_start_write(SSD1306_ADDRESS)) {
  98:keyboards/lily58/ssd1306.c ****     goto done;
  99:keyboards/lily58/ssd1306.c ****   }
 100:keyboards/lily58/ssd1306.c ****   if (i2c_master_write(0x40)) {
 101:keyboards/lily58/ssd1306.c ****     // Data mode
 102:keyboards/lily58/ssd1306.c ****     goto done;
 103:keyboards/lily58/ssd1306.c ****   }
 104:keyboards/lily58/ssd1306.c ****   for (uint8_t row = 0; row < MatrixRows; ++row) {
 105:keyboards/lily58/ssd1306.c ****     for (uint8_t col = 0; col < DisplayWidth; ++col) {
 106:keyboards/lily58/ssd1306.c ****       i2c_master_write(0);
 107:keyboards/lily58/ssd1306.c ****     }
 108:keyboards/lily58/ssd1306.c ****   }
 109:keyboards/lily58/ssd1306.c **** 
 110:keyboards/lily58/ssd1306.c ****   display.dirty = false;
 111:keyboards/lily58/ssd1306.c **** 
 112:keyboards/lily58/ssd1306.c **** done:
 113:keyboards/lily58/ssd1306.c ****   i2c_master_stop();
 114:keyboards/lily58/ssd1306.c **** }
 115:keyboards/lily58/ssd1306.c **** 
 116:keyboards/lily58/ssd1306.c **** #if DEBUG_TO_SCREEN
 117:keyboards/lily58/ssd1306.c **** #undef sendchar
 118:keyboards/lily58/ssd1306.c **** static int8_t capture_sendchar(uint8_t c) {
 119:keyboards/lily58/ssd1306.c ****   sendchar(c);
 120:keyboards/lily58/ssd1306.c ****   iota_gfx_write_char(c);
 121:keyboards/lily58/ssd1306.c **** 
 122:keyboards/lily58/ssd1306.c ****   if (!displaying) {
 123:keyboards/lily58/ssd1306.c ****     iota_gfx_flush();
 124:keyboards/lily58/ssd1306.c ****   }
 125:keyboards/lily58/ssd1306.c ****   return 0;
 126:keyboards/lily58/ssd1306.c **** }
 127:keyboards/lily58/ssd1306.c **** #endif
 128:keyboards/lily58/ssd1306.c **** 
 129:keyboards/lily58/ssd1306.c **** bool iota_gfx_init(bool rotate) {
 130:keyboards/lily58/ssd1306.c ****   bool success = false;
 131:keyboards/lily58/ssd1306.c **** 
 132:keyboards/lily58/ssd1306.c ****   i2c_master_init();
 133:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayOff);
 134:keyboards/lily58/ssd1306.c ****   send_cmd2(SetDisplayClockDiv, 0x80);
 135:keyboards/lily58/ssd1306.c ****   send_cmd2(SetMultiPlex, DisplayHeight - 1);
 136:keyboards/lily58/ssd1306.c **** 
 137:keyboards/lily58/ssd1306.c ****   send_cmd2(SetDisplayOffset, 0);
 138:keyboards/lily58/ssd1306.c **** 
 139:keyboards/lily58/ssd1306.c **** 
 140:keyboards/lily58/ssd1306.c ****   send_cmd1(SetStartLine | 0x0);
 141:keyboards/lily58/ssd1306.c ****   send_cmd2(SetChargePump, 0x14 /* Enable */);
 142:keyboards/lily58/ssd1306.c ****   send_cmd2(SetMemoryMode, 0 /* horizontal addressing */);
 143:keyboards/lily58/ssd1306.c **** 
 144:keyboards/lily58/ssd1306.c ****   if(rotate){
 145:keyboards/lily58/ssd1306.c ****     // the following Flip the display orientation 180 degrees
 146:keyboards/lily58/ssd1306.c ****     send_cmd1(SegRemap);
 147:keyboards/lily58/ssd1306.c ****     send_cmd1(ComScanInc);
 148:keyboards/lily58/ssd1306.c ****   }else{
 149:keyboards/lily58/ssd1306.c ****     // Flips the display orientation 0 degrees
 150:keyboards/lily58/ssd1306.c ****     send_cmd1(SegRemap | 0x1);
 151:keyboards/lily58/ssd1306.c ****     send_cmd1(ComScanDec);
 152:keyboards/lily58/ssd1306.c ****   }
 153:keyboards/lily58/ssd1306.c **** 
 154:keyboards/lily58/ssd1306.c ****   send_cmd2(SetComPins, 0x2);
 155:keyboards/lily58/ssd1306.c ****   send_cmd2(SetContrast, 0x8f);
 156:keyboards/lily58/ssd1306.c ****   send_cmd2(SetPreCharge, 0xf1);
 157:keyboards/lily58/ssd1306.c ****   send_cmd2(SetVComDetect, 0x40);
 158:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayAllOnResume);
 159:keyboards/lily58/ssd1306.c ****   send_cmd1(NormalDisplay);
 160:keyboards/lily58/ssd1306.c ****   send_cmd1(DeActivateScroll);
 161:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayOn);
 162:keyboards/lily58/ssd1306.c **** 
 163:keyboards/lily58/ssd1306.c ****   send_cmd2(SetContrast, 0); // Dim
 164:keyboards/lily58/ssd1306.c **** 
 165:keyboards/lily58/ssd1306.c ****   clear_display();
 166:keyboards/lily58/ssd1306.c **** 
 167:keyboards/lily58/ssd1306.c ****   success = true;
 168:keyboards/lily58/ssd1306.c **** 
 169:keyboards/lily58/ssd1306.c ****   iota_gfx_flush();
 170:keyboards/lily58/ssd1306.c **** 
 171:keyboards/lily58/ssd1306.c **** #if DEBUG_TO_SCREEN
 172:keyboards/lily58/ssd1306.c ****   print_set_sendchar(capture_sendchar);
 173:keyboards/lily58/ssd1306.c **** #endif
 174:keyboards/lily58/ssd1306.c **** 
 175:keyboards/lily58/ssd1306.c **** done:
 176:keyboards/lily58/ssd1306.c ****   return success;
 177:keyboards/lily58/ssd1306.c **** }
 178:keyboards/lily58/ssd1306.c **** 
 179:keyboards/lily58/ssd1306.c **** bool iota_gfx_off(void) {
 185               		.loc 1 179 0
 186               		.cfi_startproc
 187               	/* prologue: function */
 188               	/* frame size = 0 */
 189               	/* stack size = 0 */
 190               	.L__stack_usage = 0
 191               	.LVL21:
 180:keyboards/lily58/ssd1306.c ****   bool success = false;
 181:keyboards/lily58/ssd1306.c **** 
 182:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayOff);
 192               		.loc 1 182 0
 193 0000 8EEA      		ldi r24,lo8(-82)
 194 0002 0C94 0000 		jmp _send_cmd1
 195               	.LVL22:
 196               		.cfi_endproc
 197               	.LFE118:
 199               		.section	.text.iota_gfx_on,"ax",@progbits
 200               	.global	iota_gfx_on
 202               	iota_gfx_on:
 203               	.LFB119:
 183:keyboards/lily58/ssd1306.c ****   success = true;
 184:keyboards/lily58/ssd1306.c **** 
 185:keyboards/lily58/ssd1306.c **** done:
 186:keyboards/lily58/ssd1306.c ****   return success;
 187:keyboards/lily58/ssd1306.c **** }
 188:keyboards/lily58/ssd1306.c **** 
 189:keyboards/lily58/ssd1306.c **** bool iota_gfx_on(void) {
 204               		.loc 1 189 0
 205               		.cfi_startproc
 206               	/* prologue: function */
 207               	/* frame size = 0 */
 208               	/* stack size = 0 */
 209               	.L__stack_usage = 0
 210               	.LVL23:
 190:keyboards/lily58/ssd1306.c ****   bool success = false;
 191:keyboards/lily58/ssd1306.c **** 
 192:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayOn);
 211               		.loc 1 192 0
 212 0000 8FEA      		ldi r24,lo8(-81)
 213 0002 0C94 0000 		jmp _send_cmd1
 214               	.LVL24:
 215               		.cfi_endproc
 216               	.LFE119:
 218               		.section	.text.matrix_write_char_inner,"ax",@progbits
 219               	.global	matrix_write_char_inner
 221               	matrix_write_char_inner:
 222               	.LFB120:
 193:keyboards/lily58/ssd1306.c ****   success = true;
 194:keyboards/lily58/ssd1306.c **** 
 195:keyboards/lily58/ssd1306.c **** done:
 196:keyboards/lily58/ssd1306.c ****   return success;
 197:keyboards/lily58/ssd1306.c **** }
 198:keyboards/lily58/ssd1306.c **** 
 199:keyboards/lily58/ssd1306.c **** void matrix_write_char_inner(struct CharacterMatrix *matrix, uint8_t c) {
 223               		.loc 1 199 0
 224               		.cfi_startproc
 225               	.LVL25:
 226 0000 0F93      		push r16
 227               	.LCFI6:
 228               		.cfi_def_cfa_offset 3
 229               		.cfi_offset 16, -2
 230 0002 1F93      		push r17
 231               	.LCFI7:
 232               		.cfi_def_cfa_offset 4
 233               		.cfi_offset 17, -3
 234 0004 CF93      		push r28
 235               	.LCFI8:
 236               		.cfi_def_cfa_offset 5
 237               		.cfi_offset 28, -4
 238 0006 DF93      		push r29
 239               	.LCFI9:
 240               		.cfi_def_cfa_offset 6
 241               		.cfi_offset 29, -5
 242               	/* prologue: function */
 243               	/* frame size = 0 */
 244               	/* stack size = 4 */
 245               	.L__stack_usage = 4
 200:keyboards/lily58/ssd1306.c ****   *matrix->cursor = c;
 246               		.loc 1 200 0
 247 0008 8C01      		movw r16,r24
 248 000a 0C5A      		subi r16,-84
 249 000c 1F4F      		sbci r17,-1
 250 000e D801      		movw r26,r16
 251 0010 ED91      		ld r30,X+
 252 0012 FC91      		ld r31,X
 253 0014 1197      		sbiw r26,1
 254 0016 6083      		st Z,r22
 201:keyboards/lily58/ssd1306.c ****   ++matrix->cursor;
 255               		.loc 1 201 0
 256 0018 2D91      		ld r18,X+
 257 001a 3C91      		ld r19,X
 258 001c 1197      		sbiw r26,1
 259 001e 2F5F      		subi r18,-1
 260 0020 3F4F      		sbci r19,-1
 261 0022 2D93      		st X+,r18
 262 0024 3C93      		st X,r19
 202:keyboards/lily58/ssd1306.c **** 
 203:keyboards/lily58/ssd1306.c ****   if (matrix->cursor - &matrix->display[0][0] == sizeof(matrix->display)) {
 263               		.loc 1 203 0
 264 0026 281B      		sub r18,r24
 265 0028 390B      		sbc r19,r25
 266 002a 2435      		cpi r18,84
 267 002c 3105      		cpc r19,__zero_reg__
 268 002e 01F4      		brne .L22
 269 0030 EC01      		movw r28,r24
 204:keyboards/lily58/ssd1306.c ****     // We went off the end; scroll the display upwards by one line
 205:keyboards/lily58/ssd1306.c ****     memmove(&matrix->display[0], &matrix->display[1],
 270               		.loc 1 205 0
 271 0032 BC01      		movw r22,r24
 272               	.LVL26:
 273 0034 6B5E      		subi r22,-21
 274 0036 7F4F      		sbci r23,-1
 275 0038 4FE3      		ldi r20,lo8(63)
 276 003a 50E0      		ldi r21,0
 277 003c 0E94 0000 		call memmove
 278               	.LVL27:
 206:keyboards/lily58/ssd1306.c ****             MatrixCols * (MatrixRows - 1));
 207:keyboards/lily58/ssd1306.c ****     matrix->cursor = &matrix->display[MatrixRows - 1][0];
 279               		.loc 1 207 0
 280 0040 CE01      		movw r24,r28
 281 0042 CF96      		adiw r24,63
 282 0044 F801      		movw r30,r16
 283 0046 9183      		std Z+1,r25
 284 0048 8083      		st Z,r24
 208:keyboards/lily58/ssd1306.c ****     memset(matrix->cursor, ' ', MatrixCols);
 285               		.loc 1 208 0
 286 004a 45E1      		ldi r20,lo8(21)
 287 004c 50E0      		ldi r21,0
 288 004e 60E2      		ldi r22,lo8(32)
 289 0050 70E0      		ldi r23,0
 290               	/* epilogue start */
 209:keyboards/lily58/ssd1306.c ****   }
 210:keyboards/lily58/ssd1306.c **** }
 291               		.loc 1 210 0
 292 0052 DF91      		pop r29
 293 0054 CF91      		pop r28
 294               	.LVL28:
 295 0056 1F91      		pop r17
 296 0058 0F91      		pop r16
 208:keyboards/lily58/ssd1306.c ****     memset(matrix->cursor, ' ', MatrixCols);
 297               		.loc 1 208 0
 298 005a 0C94 0000 		jmp memset
 299               	.LVL29:
 300               	.L22:
 301               	/* epilogue start */
 302               		.loc 1 210 0
 303 005e DF91      		pop r29
 304 0060 CF91      		pop r28
 305 0062 1F91      		pop r17
 306 0064 0F91      		pop r16
 307 0066 0895      		ret
 308               		.cfi_endproc
 309               	.LFE120:
 311               		.section	.text.matrix_write_char,"ax",@progbits
 312               	.global	matrix_write_char
 314               	matrix_write_char:
 315               	.LFB121:
 211:keyboards/lily58/ssd1306.c **** 
 212:keyboards/lily58/ssd1306.c **** void matrix_write_char(struct CharacterMatrix *matrix, uint8_t c) {
 316               		.loc 1 212 0
 317               		.cfi_startproc
 318               	.LVL30:
 319 0000 1F93      		push r17
 320               	.LCFI10:
 321               		.cfi_def_cfa_offset 3
 322               		.cfi_offset 17, -2
 323 0002 CF93      		push r28
 324               	.LCFI11:
 325               		.cfi_def_cfa_offset 4
 326               		.cfi_offset 28, -3
 327 0004 DF93      		push r29
 328               	.LCFI12:
 329               		.cfi_def_cfa_offset 5
 330               		.cfi_offset 29, -4
 331               	/* prologue: function */
 332               	/* frame size = 0 */
 333               	/* stack size = 3 */
 334               	.L__stack_usage = 3
 213:keyboards/lily58/ssd1306.c ****   matrix->dirty = true;
 335               		.loc 1 213 0
 336 0006 FC01      		movw r30,r24
 337 0008 EA5A      		subi r30,-86
 338 000a FF4F      		sbci r31,-1
 339 000c 21E0      		ldi r18,lo8(1)
 340 000e 2083      		st Z,r18
 214:keyboards/lily58/ssd1306.c **** 
 215:keyboards/lily58/ssd1306.c ****   if (c == '\n') {
 341               		.loc 1 215 0
 342 0010 6A30      		cpi r22,lo8(10)
 343 0012 01F4      		brne .L25
 344 0014 EC01      		movw r28,r24
 345               	.LBB12:
 216:keyboards/lily58/ssd1306.c ****     // Clear to end of line from the cursor and then move to the
 217:keyboards/lily58/ssd1306.c ****     // start of the next line
 218:keyboards/lily58/ssd1306.c ****     uint8_t cursor_col = (matrix->cursor - &matrix->display[0][0]) % MatrixCols;
 346               		.loc 1 218 0
 347 0016 3297      		sbiw r30,2
 348 0018 8081      		ld r24,Z
 349 001a 9181      		ldd r25,Z+1
 350               	.LVL31:
 351 001c 8C1B      		sub r24,r28
 352 001e 9D0B      		sbc r25,r29
 353 0020 65E1      		ldi r22,lo8(21)
 354 0022 70E0      		ldi r23,0
 355               	.LVL32:
 356 0024 0E94 0000 		call __divmodhi4
 357               	.LVL33:
 219:keyboards/lily58/ssd1306.c **** 
 220:keyboards/lily58/ssd1306.c ****     while (cursor_col++ < MatrixCols) {
 358               		.loc 1 220 0
 359 0028 182F      		mov r17,r24
 360               	.LVL34:
 361               	.L26:
 362 002a 1531      		cpi r17,lo8(21)
 363 002c 00F4      		brsh .L30
 221:keyboards/lily58/ssd1306.c ****       matrix_write_char_inner(matrix, ' ');
 364               		.loc 1 221 0
 365 002e 60E2      		ldi r22,lo8(32)
 366 0030 CE01      		movw r24,r28
 367 0032 0E94 0000 		call matrix_write_char_inner
 368               	.LVL35:
 369 0036 1F5F      		subi r17,lo8(-(1))
 370               	.LVL36:
 371 0038 00C0      		rjmp .L26
 372               	.LVL37:
 373               	.L25:
 374               	/* epilogue start */
 375               	.LBE12:
 222:keyboards/lily58/ssd1306.c ****     }
 223:keyboards/lily58/ssd1306.c ****     return;
 224:keyboards/lily58/ssd1306.c ****   }
 225:keyboards/lily58/ssd1306.c **** 
 226:keyboards/lily58/ssd1306.c ****   matrix_write_char_inner(matrix, c);
 227:keyboards/lily58/ssd1306.c **** }
 376               		.loc 1 227 0
 377 003a DF91      		pop r29
 378 003c CF91      		pop r28
 379 003e 1F91      		pop r17
 226:keyboards/lily58/ssd1306.c **** }
 380               		.loc 1 226 0
 381 0040 0C94 0000 		jmp matrix_write_char_inner
 382               	.LVL38:
 383               	.L30:
 384               	/* epilogue start */
 385               		.loc 1 227 0
 386 0044 DF91      		pop r29
 387 0046 CF91      		pop r28
 388               	.LVL39:
 389 0048 1F91      		pop r17
 390               	.LVL40:
 391 004a 0895      		ret
 392               		.cfi_endproc
 393               	.LFE121:
 395               		.section	.text.iota_gfx_write_char,"ax",@progbits
 396               	.global	iota_gfx_write_char
 398               	iota_gfx_write_char:
 399               	.LFB122:
 228:keyboards/lily58/ssd1306.c **** 
 229:keyboards/lily58/ssd1306.c **** void iota_gfx_write_char(uint8_t c) {
 400               		.loc 1 229 0
 401               		.cfi_startproc
 402               	.LVL41:
 403               	/* prologue: function */
 404               	/* frame size = 0 */
 405               	/* stack size = 0 */
 406               	.L__stack_usage = 0
 230:keyboards/lily58/ssd1306.c ****   matrix_write_char(&display, c);
 407               		.loc 1 230 0
 408 0000 682F      		mov r22,r24
 409 0002 80E0      		ldi r24,lo8(display)
 410 0004 90E0      		ldi r25,hi8(display)
 411               	.LVL42:
 412 0006 0C94 0000 		jmp matrix_write_char
 413               	.LVL43:
 414               		.cfi_endproc
 415               	.LFE122:
 417               		.section	.text.matrix_write,"ax",@progbits
 418               	.global	matrix_write
 420               	matrix_write:
 421               	.LFB123:
 231:keyboards/lily58/ssd1306.c **** }
 232:keyboards/lily58/ssd1306.c **** 
 233:keyboards/lily58/ssd1306.c **** void matrix_write(struct CharacterMatrix *matrix, const char *data) {
 422               		.loc 1 233 0
 423               		.cfi_startproc
 424               	.LVL44:
 425 0000 EF92      		push r14
 426               	.LCFI13:
 427               		.cfi_def_cfa_offset 3
 428               		.cfi_offset 14, -2
 429 0002 FF92      		push r15
 430               	.LCFI14:
 431               		.cfi_def_cfa_offset 4
 432               		.cfi_offset 15, -3
 433 0004 0F93      		push r16
 434               	.LCFI15:
 435               		.cfi_def_cfa_offset 5
 436               		.cfi_offset 16, -4
 437 0006 1F93      		push r17
 438               	.LCFI16:
 439               		.cfi_def_cfa_offset 6
 440               		.cfi_offset 17, -5
 441 0008 CF93      		push r28
 442               	.LCFI17:
 443               		.cfi_def_cfa_offset 7
 444               		.cfi_offset 28, -6
 445 000a DF93      		push r29
 446               	.LCFI18:
 447               		.cfi_def_cfa_offset 8
 448               		.cfi_offset 29, -7
 449               	/* prologue: function */
 450               	/* frame size = 0 */
 451               	/* stack size = 6 */
 452               	.L__stack_usage = 6
 453 000c 7C01      		movw r14,r24
 454 000e EB01      		movw r28,r22
 234:keyboards/lily58/ssd1306.c ****   const char *end = data + strlen(data);
 455               		.loc 1 234 0
 456 0010 FB01      		movw r30,r22
 457               		0:
 458 0012 0190      		ld __tmp_reg__,Z+
 459 0014 0020      		tst __tmp_reg__
 460 0016 01F4      		brne 0b
 461 0018 8F01      		movw r16,r30
 462 001a 0150      		subi r16,1
 463 001c 1109      		sbc r17,__zero_reg__
 464               	.LVL45:
 465               	.L33:
 235:keyboards/lily58/ssd1306.c ****   while (data < end) {
 466               		.loc 1 235 0
 467 001e C017      		cp r28,r16
 468 0020 D107      		cpc r29,r17
 469 0022 00F4      		brsh .L35
 236:keyboards/lily58/ssd1306.c ****     matrix_write_char(matrix, *data);
 470               		.loc 1 236 0
 471 0024 6991      		ld r22,Y+
 472               	.LVL46:
 473 0026 C701      		movw r24,r14
 474 0028 0E94 0000 		call matrix_write_char
 475               	.LVL47:
 476 002c 00C0      		rjmp .L33
 477               	.L35:
 478               	/* epilogue start */
 237:keyboards/lily58/ssd1306.c ****     ++data;
 238:keyboards/lily58/ssd1306.c ****   }
 239:keyboards/lily58/ssd1306.c **** }
 479               		.loc 1 239 0
 480 002e DF91      		pop r29
 481 0030 CF91      		pop r28
 482               	.LVL48:
 483 0032 1F91      		pop r17
 484 0034 0F91      		pop r16
 485               	.LVL49:
 486 0036 FF90      		pop r15
 487 0038 EF90      		pop r14
 488               	.LVL50:
 489 003a 0895      		ret
 490               		.cfi_endproc
 491               	.LFE123:
 493               		.section	.rodata.str1.1,"aMS",@progbits,1
 494               	.LC0:
 495 0000 2573 0A00 		.string	"%s\n"
 496               		.section	.text.matrix_write_ln,"ax",@progbits
 497               	.global	matrix_write_ln
 499               	matrix_write_ln:
 500               	.LFB124:
 240:keyboards/lily58/ssd1306.c **** 
 241:keyboards/lily58/ssd1306.c **** void matrix_write_ln(struct CharacterMatrix *matrix, const char *data) {
 501               		.loc 1 241 0
 502               		.cfi_startproc
 503               	.LVL51:
 504 0000 CF92      		push r12
 505               	.LCFI19:
 506               		.cfi_def_cfa_offset 3
 507               		.cfi_offset 12, -2
 508 0002 DF92      		push r13
 509               	.LCFI20:
 510               		.cfi_def_cfa_offset 4
 511               		.cfi_offset 13, -3
 512 0004 EF92      		push r14
 513               	.LCFI21:
 514               		.cfi_def_cfa_offset 5
 515               		.cfi_offset 14, -4
 516 0006 FF92      		push r15
 517               	.LCFI22:
 518               		.cfi_def_cfa_offset 6
 519               		.cfi_offset 15, -5
 520 0008 0F93      		push r16
 521               	.LCFI23:
 522               		.cfi_def_cfa_offset 7
 523               		.cfi_offset 16, -6
 524 000a 1F93      		push r17
 525               	.LCFI24:
 526               		.cfi_def_cfa_offset 8
 527               		.cfi_offset 17, -7
 528 000c CF93      		push r28
 529               	.LCFI25:
 530               		.cfi_def_cfa_offset 9
 531               		.cfi_offset 28, -8
 532 000e DF93      		push r29
 533               	.LCFI26:
 534               		.cfi_def_cfa_offset 10
 535               		.cfi_offset 29, -9
 536 0010 CDB7      		in r28,__SP_L__
 537 0012 DEB7      		in r29,__SP_H__
 538               	.LCFI27:
 539               		.cfi_def_cfa_register 28
 540               	/* prologue: function */
 541               	/* frame size = 0 */
 542               	/* stack size = 8 */
 543               	.L__stack_usage = 8
 544 0014 6C01      		movw r12,r24
 242:keyboards/lily58/ssd1306.c ****   char data_ln[strlen(data)+2];
 243:keyboards/lily58/ssd1306.c ****   snprintf(data_ln, sizeof(data_ln), "%s\n", data);
 244:keyboards/lily58/ssd1306.c ****   matrix_write(matrix, data_ln);
 245:keyboards/lily58/ssd1306.c **** }
 545               		.loc 1 245 0
 546 0016 EDB6      		in r14,__SP_L__
 547 0018 FEB6      		in r15,__SP_H__
 242:keyboards/lily58/ssd1306.c ****   char data_ln[strlen(data)+2];
 548               		.loc 1 242 0
 549 001a DB01      		movw r26,r22
 550               		0:
 551 001c 0D90      		ld __tmp_reg__,X+
 552 001e 0020      		tst __tmp_reg__
 553 0020 01F4      		brne 0b
 554 0022 9D01      		movw r18,r26
 555 0024 261B      		sub r18,r22
 556 0026 370B      		sbc r19,r23
 557 0028 2F5F      		subi r18,-1
 558 002a 3F4F      		sbci r19,-1
 559               	.LVL52:
 560 002c 8DB7      		in r24,__SP_L__
 561 002e 9EB7      		in r25,__SP_H__
 562               	.LVL53:
 563 0030 821B      		sub r24,r18
 564 0032 930B      		sbc r25,r19
 565 0034 0FB6      		in __tmp_reg__,__SREG__
 566 0036 F894      		cli
 567 0038 9EBF      		out __SP_H__,r25
 568 003a 0FBE      		out __SREG__,__tmp_reg__
 569 003c 8DBF      		out __SP_L__,r24
 570 003e 0DB7      		in r16,__SP_L__
 571 0040 1EB7      		in r17,__SP_H__
 572 0042 0F5F      		subi r16,-1
 573 0044 1F4F      		sbci r17,-1
 574               	.LVL54:
 243:keyboards/lily58/ssd1306.c ****   matrix_write(matrix, data_ln);
 575               		.loc 1 243 0
 576 0046 7F93      		push r23
 577 0048 6F93      		push r22
 578 004a 80E0      		ldi r24,lo8(.LC0)
 579 004c 90E0      		ldi r25,hi8(.LC0)
 580 004e 9F93      		push r25
 581 0050 8F93      		push r24
 582 0052 3F93      		push r19
 583 0054 2F93      		push r18
 584 0056 1F93      		push r17
 585 0058 0F93      		push r16
 586 005a 0E94 0000 		call snprintf
 587               	.LVL55:
 244:keyboards/lily58/ssd1306.c **** }
 588               		.loc 1 244 0
 589 005e B801      		movw r22,r16
 590 0060 C601      		movw r24,r12
 591 0062 0E94 0000 		call matrix_write
 592               	.LVL56:
 593 0066 8DB7      		in r24,__SP_L__
 594 0068 9EB7      		in r25,__SP_H__
 595 006a 0896      		adiw r24,8
 596 006c 0FB6      		in __tmp_reg__,__SREG__
 597 006e F894      		cli
 598 0070 9EBF      		out __SP_H__,r25
 599 0072 0FBE      		out __SREG__,__tmp_reg__
 600 0074 8DBF      		out __SP_L__,r24
 601               		.loc 1 245 0
 602 0076 0FB6      		in __tmp_reg__,__SREG__
 603 0078 F894      		cli
 604 007a FEBE      		out __SP_H__,r15
 605 007c 0FBE      		out __SREG__,__tmp_reg__
 606 007e EDBE      		out __SP_L__,r14
 607               	/* epilogue start */
 608 0080 DF91      		pop r29
 609 0082 CF91      		pop r28
 610 0084 1F91      		pop r17
 611 0086 0F91      		pop r16
 612               	.LVL57:
 613 0088 FF90      		pop r15
 614 008a EF90      		pop r14
 615 008c DF90      		pop r13
 616 008e CF90      		pop r12
 617               	.LVL58:
 618 0090 0895      		ret
 619               		.cfi_endproc
 620               	.LFE124:
 622               		.section	.text.iota_gfx_write,"ax",@progbits
 623               	.global	iota_gfx_write
 625               	iota_gfx_write:
 626               	.LFB125:
 246:keyboards/lily58/ssd1306.c **** 
 247:keyboards/lily58/ssd1306.c **** void iota_gfx_write(const char *data) {
 627               		.loc 1 247 0
 628               		.cfi_startproc
 629               	.LVL59:
 630               	/* prologue: function */
 631               	/* frame size = 0 */
 632               	/* stack size = 0 */
 633               	.L__stack_usage = 0
 248:keyboards/lily58/ssd1306.c ****   matrix_write(&display, data);
 634               		.loc 1 248 0
 635 0000 BC01      		movw r22,r24
 636 0002 80E0      		ldi r24,lo8(display)
 637 0004 90E0      		ldi r25,hi8(display)
 638               	.LVL60:
 639 0006 0C94 0000 		jmp matrix_write
 640               	.LVL61:
 641               		.cfi_endproc
 642               	.LFE125:
 644               		.section	.text.matrix_write_P,"ax",@progbits
 645               	.global	matrix_write_P
 647               	matrix_write_P:
 648               	.LFB126:
 249:keyboards/lily58/ssd1306.c **** }
 250:keyboards/lily58/ssd1306.c **** 
 251:keyboards/lily58/ssd1306.c **** void matrix_write_P(struct CharacterMatrix *matrix, const char *data) {
 649               		.loc 1 251 0
 650               		.cfi_startproc
 651               	.LVL62:
 652 0000 0F93      		push r16
 653               	.LCFI28:
 654               		.cfi_def_cfa_offset 3
 655               		.cfi_offset 16, -2
 656 0002 1F93      		push r17
 657               	.LCFI29:
 658               		.cfi_def_cfa_offset 4
 659               		.cfi_offset 17, -3
 660 0004 CF93      		push r28
 661               	.LCFI30:
 662               		.cfi_def_cfa_offset 5
 663               		.cfi_offset 28, -4
 664 0006 DF93      		push r29
 665               	.LCFI31:
 666               		.cfi_def_cfa_offset 6
 667               		.cfi_offset 29, -5
 668               	/* prologue: function */
 669               	/* frame size = 0 */
 670               	/* stack size = 4 */
 671               	.L__stack_usage = 4
 672 0008 8C01      		movw r16,r24
 673 000a EB01      		movw r28,r22
 674               	.LVL63:
 675               	.L40:
 676               	.LBB13:
 677               	.LBB14:
 252:keyboards/lily58/ssd1306.c ****   while (true) {
 253:keyboards/lily58/ssd1306.c ****     uint8_t c = pgm_read_byte(data);
 678               		.loc 1 253 0
 679 000c FE01      		movw r30,r28
 680               	/* #APP */
 681               	 ;  253 "keyboards/lily58/ssd1306.c" 1
 682 000e 6491      		lpm r22, Z
 683               		
 684               	 ;  0 "" 2
 685               	.LVL64:
 686               	/* #NOAPP */
 687               	.LBE14:
 254:keyboards/lily58/ssd1306.c ****     if (c == 0) {
 688               		.loc 1 254 0
 689 0010 6623      		tst r22
 690 0012 01F0      		breq .L38
 255:keyboards/lily58/ssd1306.c ****       return;
 256:keyboards/lily58/ssd1306.c ****     }
 257:keyboards/lily58/ssd1306.c ****     matrix_write_char(matrix, c);
 691               		.loc 1 257 0
 692 0014 C801      		movw r24,r16
 693 0016 0E94 0000 		call matrix_write_char
 694               	.LVL65:
 258:keyboards/lily58/ssd1306.c ****     ++data;
 695               		.loc 1 258 0
 696 001a 2196      		adiw r28,1
 697               	.LVL66:
 698               	.LBE13:
 259:keyboards/lily58/ssd1306.c ****   }
 699               		.loc 1 259 0
 700 001c 00C0      		rjmp .L40
 701               	.LVL67:
 702               	.L38:
 703               	/* epilogue start */
 260:keyboards/lily58/ssd1306.c **** }
 704               		.loc 1 260 0
 705 001e DF91      		pop r29
 706 0020 CF91      		pop r28
 707               	.LVL68:
 708 0022 1F91      		pop r17
 709 0024 0F91      		pop r16
 710               	.LVL69:
 711 0026 0895      		ret
 712               		.cfi_endproc
 713               	.LFE126:
 715               		.section	.text.iota_gfx_write_P,"ax",@progbits
 716               	.global	iota_gfx_write_P
 718               	iota_gfx_write_P:
 719               	.LFB127:
 261:keyboards/lily58/ssd1306.c **** 
 262:keyboards/lily58/ssd1306.c **** void iota_gfx_write_P(const char *data) {
 720               		.loc 1 262 0
 721               		.cfi_startproc
 722               	.LVL70:
 723               	/* prologue: function */
 724               	/* frame size = 0 */
 725               	/* stack size = 0 */
 726               	.L__stack_usage = 0
 263:keyboards/lily58/ssd1306.c ****   matrix_write_P(&display, data);
 727               		.loc 1 263 0
 728 0000 BC01      		movw r22,r24
 729 0002 80E0      		ldi r24,lo8(display)
 730 0004 90E0      		ldi r25,hi8(display)
 731               	.LVL71:
 732 0006 0C94 0000 		jmp matrix_write_P
 733               	.LVL72:
 734               		.cfi_endproc
 735               	.LFE127:
 737               		.section	.text.matrix_clear,"ax",@progbits
 738               	.global	matrix_clear
 740               	matrix_clear:
 741               	.LFB128:
 264:keyboards/lily58/ssd1306.c **** }
 265:keyboards/lily58/ssd1306.c **** 
 266:keyboards/lily58/ssd1306.c **** void matrix_clear(struct CharacterMatrix *matrix) {
 742               		.loc 1 266 0
 743               		.cfi_startproc
 744               	.LVL73:
 745 0000 CF93      		push r28
 746               	.LCFI32:
 747               		.cfi_def_cfa_offset 3
 748               		.cfi_offset 28, -2
 749 0002 DF93      		push r29
 750               	.LCFI33:
 751               		.cfi_def_cfa_offset 4
 752               		.cfi_offset 29, -3
 753               	/* prologue: function */
 754               	/* frame size = 0 */
 755               	/* stack size = 2 */
 756               	.L__stack_usage = 2
 757 0004 EC01      		movw r28,r24
 267:keyboards/lily58/ssd1306.c ****   memset(matrix->display, ' ', sizeof(matrix->display));
 758               		.loc 1 267 0
 759 0006 44E5      		ldi r20,lo8(84)
 760 0008 50E0      		ldi r21,0
 761 000a 60E2      		ldi r22,lo8(32)
 762 000c 70E0      		ldi r23,0
 763 000e 0E94 0000 		call memset
 764               	.LVL74:
 268:keyboards/lily58/ssd1306.c ****   matrix->cursor = &matrix->display[0][0];
 765               		.loc 1 268 0
 766 0012 FE01      		movw r30,r28
 767 0014 EC5A      		subi r30,-84
 768 0016 FF4F      		sbci r31,-1
 769 0018 D183      		std Z+1,r29
 770 001a C083      		st Z,r28
 269:keyboards/lily58/ssd1306.c ****   matrix->dirty = true;
 771               		.loc 1 269 0
 772 001c CA5A      		subi r28,-86
 773 001e DF4F      		sbci r29,-1
 774               	.LVL75:
 775 0020 81E0      		ldi r24,lo8(1)
 776 0022 8883      		st Y,r24
 777               	/* epilogue start */
 270:keyboards/lily58/ssd1306.c **** }
 778               		.loc 1 270 0
 779 0024 DF91      		pop r29
 780 0026 CF91      		pop r28
 781 0028 0895      		ret
 782               		.cfi_endproc
 783               	.LFE128:
 785               		.section	.text.iota_gfx_clear_screen,"ax",@progbits
 786               	.global	iota_gfx_clear_screen
 788               	iota_gfx_clear_screen:
 789               	.LFB129:
 271:keyboards/lily58/ssd1306.c **** 
 272:keyboards/lily58/ssd1306.c **** void iota_gfx_clear_screen(void) {
 790               		.loc 1 272 0
 791               		.cfi_startproc
 792               	/* prologue: function */
 793               	/* frame size = 0 */
 794               	/* stack size = 0 */
 795               	.L__stack_usage = 0
 273:keyboards/lily58/ssd1306.c ****   matrix_clear(&display);
 796               		.loc 1 273 0
 797 0000 80E0      		ldi r24,lo8(display)
 798 0002 90E0      		ldi r25,hi8(display)
 799 0004 0C94 0000 		jmp matrix_clear
 800               	.LVL76:
 801               		.cfi_endproc
 802               	.LFE129:
 804               		.section	.text.matrix_render,"ax",@progbits
 805               	.global	matrix_render
 807               	matrix_render:
 808               	.LFB130:
 274:keyboards/lily58/ssd1306.c **** }
 275:keyboards/lily58/ssd1306.c **** 
 276:keyboards/lily58/ssd1306.c **** void matrix_render(struct CharacterMatrix *matrix) {
 809               		.loc 1 276 0
 810               		.cfi_startproc
 811               	.LVL77:
 812 0000 8F92      		push r8
 813               	.LCFI34:
 814               		.cfi_def_cfa_offset 3
 815               		.cfi_offset 8, -2
 816 0002 9F92      		push r9
 817               	.LCFI35:
 818               		.cfi_def_cfa_offset 4
 819               		.cfi_offset 9, -3
 820 0004 AF92      		push r10
 821               	.LCFI36:
 822               		.cfi_def_cfa_offset 5
 823               		.cfi_offset 10, -4
 824 0006 BF92      		push r11
 825               	.LCFI37:
 826               		.cfi_def_cfa_offset 6
 827               		.cfi_offset 11, -5
 828 0008 DF92      		push r13
 829               	.LCFI38:
 830               		.cfi_def_cfa_offset 7
 831               		.cfi_offset 13, -6
 832 000a EF92      		push r14
 833               	.LCFI39:
 834               		.cfi_def_cfa_offset 8
 835               		.cfi_offset 14, -7
 836 000c FF92      		push r15
 837               	.LCFI40:
 838               		.cfi_def_cfa_offset 9
 839               		.cfi_offset 15, -8
 840 000e 0F93      		push r16
 841               	.LCFI41:
 842               		.cfi_def_cfa_offset 10
 843               		.cfi_offset 16, -9
 844 0010 1F93      		push r17
 845               	.LCFI42:
 846               		.cfi_def_cfa_offset 11
 847               		.cfi_offset 17, -10
 848 0012 CF93      		push r28
 849               	.LCFI43:
 850               		.cfi_def_cfa_offset 12
 851               		.cfi_offset 28, -11
 852 0014 DF93      		push r29
 853               	.LCFI44:
 854               		.cfi_def_cfa_offset 13
 855               		.cfi_offset 29, -12
 856               	/* prologue: function */
 857               	/* frame size = 0 */
 858               	/* stack size = 11 */
 859               	.L__stack_usage = 11
 860 0016 EC01      		movw r28,r24
 277:keyboards/lily58/ssd1306.c ****   last_flush = timer_read();
 861               		.loc 1 277 0
 862 0018 0E94 0000 		call timer_read
 863               	.LVL78:
 864 001c 9093 0000 		sts last_flush+1,r25
 865 0020 8093 0000 		sts last_flush,r24
 278:keyboards/lily58/ssd1306.c ****   iota_gfx_on();
 866               		.loc 1 278 0
 867 0024 0E94 0000 		call iota_gfx_on
 868               	.LVL79:
 279:keyboards/lily58/ssd1306.c **** #if DEBUG_TO_SCREEN
 280:keyboards/lily58/ssd1306.c ****   ++displaying;
 281:keyboards/lily58/ssd1306.c **** #endif
 282:keyboards/lily58/ssd1306.c **** 
 283:keyboards/lily58/ssd1306.c ****   // Move to the home position
 284:keyboards/lily58/ssd1306.c ****   send_cmd3(PageAddr, 0, MatrixRows - 1);
 869               		.loc 1 284 0
 870 0028 63E0      		ldi r22,lo8(3)
 871 002a 82E2      		ldi r24,lo8(34)
 872 002c 0E94 0000 		call _send_cmd3.constprop.1
 873               	.LVL80:
 874 0030 8823      		tst r24
 875 0032 01F4      		brne .+2
 876 0034 00C0      		rjmp .L46
 285:keyboards/lily58/ssd1306.c ****   send_cmd3(ColumnAddr, 0, (MatrixCols * FontWidth) - 1);
 877               		.loc 1 285 0
 878 0036 6DE7      		ldi r22,lo8(125)
 879 0038 81E2      		ldi r24,lo8(33)
 880 003a 0E94 0000 		call _send_cmd3.constprop.1
 881               	.LVL81:
 882 003e 8823      		tst r24
 883 0040 01F0      		breq .L46
 884               	.LVL82:
 885               	.LBB23:
 886               	.LBB24:
 887               		.loc 2 36 0
 888 0042 88E7      		ldi r24,lo8(120)
 889 0044 0E94 0000 		call i2c_master_start
 890               	.LVL83:
 891               	.LBE24:
 892               	.LBE23:
 286:keyboards/lily58/ssd1306.c **** 
 287:keyboards/lily58/ssd1306.c ****   if (i2c_start_write(SSD1306_ADDRESS)) {
 893               		.loc 1 287 0
 894 0048 8111      		cpse r24,__zero_reg__
 895 004a 00C0      		rjmp .L46
 288:keyboards/lily58/ssd1306.c ****     goto done;
 289:keyboards/lily58/ssd1306.c ****   }
 290:keyboards/lily58/ssd1306.c ****   if (i2c_master_write(0x40)) {
 896               		.loc 1 290 0
 897 004c 80E4      		ldi r24,lo8(64)
 898 004e 0E94 0000 		call i2c_master_write
 899               	.LVL84:
 900 0052 8111      		cpse r24,__zero_reg__
 901 0054 00C0      		rjmp .L46
 902 0056 4E01      		movw r8,r28
 903 0058 84E0      		ldi r24,lo8(4)
 904 005a D82E      		mov r13,r24
 905               	.L48:
 906               	.LVL85:
 276:keyboards/lily58/ssd1306.c ****   last_flush = timer_read();
 907               		.loc 1 276 0
 908 005c 00E0      		ldi r16,0
 909 005e 10E0      		ldi r17,0
 910               	.LVL86:
 911               	.L50:
 912 0060 F401      		movw r30,r8
 913 0062 E00F      		add r30,r16
 914 0064 F11F      		adc r31,r17
 915               	.LBB25:
 916               	.LBB26:
 917               	.LBB27:
 291:keyboards/lily58/ssd1306.c ****     // Data mode
 292:keyboards/lily58/ssd1306.c ****     goto done;
 293:keyboards/lily58/ssd1306.c ****   }
 294:keyboards/lily58/ssd1306.c **** 
 295:keyboards/lily58/ssd1306.c ****   for (uint8_t row = 0; row < MatrixRows; ++row) {
 296:keyboards/lily58/ssd1306.c ****     for (uint8_t col = 0; col < MatrixCols; ++col) {
 297:keyboards/lily58/ssd1306.c ****       const uint8_t *glyph = font + (matrix->display[row][col] * FontWidth);
 918               		.loc 1 297 0
 919 0066 A080      		ld r10,Z
 920 0068 86E0      		ldi r24,lo8(6)
 921 006a A89E      		mul r10,r24
 922 006c 5001      		movw r10,r0
 923 006e 1124      		clr __zero_reg__
 924               	.LVL87:
 925 0070 E12C      		mov r14,__zero_reg__
 926 0072 F12C      		mov r15,__zero_reg__
 927               	.LVL88:
 928               	.L49:
 929 0074 F701      		movw r30,r14
 930 0076 EA0D      		add r30,r10
 931 0078 FB1D      		adc r31,r11
 932 007a E050      		subi r30,lo8(-(font))
 933 007c F040      		sbci r31,hi8(-(font))
 934               	.LVL89:
 935               	.LBB28:
 936               	.LBB29:
 937               	.LBB30:
 298:keyboards/lily58/ssd1306.c **** 
 299:keyboards/lily58/ssd1306.c ****       for (uint8_t glyphCol = 0; glyphCol < FontWidth; ++glyphCol) {
 300:keyboards/lily58/ssd1306.c ****         uint8_t colBits = pgm_read_byte(glyph + glyphCol);
 938               		.loc 1 300 0 discriminator 3
 939               	/* #APP */
 940               	 ;  300 "keyboards/lily58/ssd1306.c" 1
 941 007e 8491      		lpm r24, Z
 942               		
 943               	 ;  0 "" 2
 944               	.LVL90:
 945               	/* #NOAPP */
 946               	.LBE30:
 301:keyboards/lily58/ssd1306.c ****         i2c_master_write(colBits);
 947               		.loc 1 301 0 discriminator 3
 948 0080 0E94 0000 		call i2c_master_write
 949               	.LVL91:
 950 0084 8FEF      		ldi r24,-1
 951 0086 E81A      		sub r14,r24
 952 0088 F80A      		sbc r15,r24
 953               	.LVL92:
 954               	.LBE29:
 299:keyboards/lily58/ssd1306.c ****         uint8_t colBits = pgm_read_byte(glyph + glyphCol);
 955               		.loc 1 299 0 discriminator 3
 956 008a 86E0      		ldi r24,6
 957 008c E816      		cp r14,r24
 958 008e F104      		cpc r15,__zero_reg__
 959 0090 01F4      		brne .L49
 960               	.LVL93:
 961 0092 0F5F      		subi r16,-1
 962 0094 1F4F      		sbci r17,-1
 963               	.LVL94:
 964               	.LBE28:
 965               	.LBE27:
 296:keyboards/lily58/ssd1306.c ****       const uint8_t *glyph = font + (matrix->display[row][col] * FontWidth);
 966               		.loc 1 296 0 discriminator 2
 967 0096 0531      		cpi r16,21
 968 0098 1105      		cpc r17,__zero_reg__
 969 009a 01F4      		brne .L50
 970               	.LVL95:
 971 009c DA94      		dec r13
 972               	.LVL96:
 973 009e 85E1      		ldi r24,21
 974 00a0 880E      		add r8,r24
 975 00a2 911C      		adc r9,__zero_reg__
 976               	.LBE26:
 295:keyboards/lily58/ssd1306.c ****     for (uint8_t col = 0; col < MatrixCols; ++col) {
 977               		.loc 1 295 0 discriminator 2
 978 00a4 D110      		cpse r13,__zero_reg__
 979 00a6 00C0      		rjmp .L48
 980               	.LBE25:
 302:keyboards/lily58/ssd1306.c ****       }
 303:keyboards/lily58/ssd1306.c **** 
 304:keyboards/lily58/ssd1306.c ****       // 1 column of space between chars (it's not included in the glyph)
 305:keyboards/lily58/ssd1306.c ****       //i2c_master_write(0);
 306:keyboards/lily58/ssd1306.c ****     }
 307:keyboards/lily58/ssd1306.c ****   }
 308:keyboards/lily58/ssd1306.c **** 
 309:keyboards/lily58/ssd1306.c ****   matrix->dirty = false;
 981               		.loc 1 309 0
 982 00a8 CA5A      		subi r28,-86
 983 00aa DF4F      		sbci r29,-1
 984               	.LVL97:
 985 00ac 1882      		st Y,__zero_reg__
 986               	.LVL98:
 987               	.L46:
 988               	/* epilogue start */
 310:keyboards/lily58/ssd1306.c **** 
 311:keyboards/lily58/ssd1306.c **** done:
 312:keyboards/lily58/ssd1306.c ****   i2c_master_stop();
 313:keyboards/lily58/ssd1306.c **** #if DEBUG_TO_SCREEN
 314:keyboards/lily58/ssd1306.c ****   --displaying;
 315:keyboards/lily58/ssd1306.c **** #endif
 316:keyboards/lily58/ssd1306.c **** }
 989               		.loc 1 316 0
 990 00ae DF91      		pop r29
 991 00b0 CF91      		pop r28
 992 00b2 1F91      		pop r17
 993 00b4 0F91      		pop r16
 994 00b6 FF90      		pop r15
 995 00b8 EF90      		pop r14
 996 00ba DF90      		pop r13
 997 00bc BF90      		pop r11
 998 00be AF90      		pop r10
 999 00c0 9F90      		pop r9
 1000 00c2 8F90      		pop r8
 312:keyboards/lily58/ssd1306.c **** #if DEBUG_TO_SCREEN
 1001               		.loc 1 312 0
 1002 00c4 0C94 0000 		jmp i2c_master_stop
 1003               	.LVL99:
 1004               		.cfi_endproc
 1005               	.LFE130:
 1007               		.section	.text.iota_gfx_flush,"ax",@progbits
 1008               	.global	iota_gfx_flush
 1010               	iota_gfx_flush:
 1011               	.LFB131:
 317:keyboards/lily58/ssd1306.c **** 
 318:keyboards/lily58/ssd1306.c **** void iota_gfx_flush(void) {
 1012               		.loc 1 318 0
 1013               		.cfi_startproc
 1014               	/* prologue: function */
 1015               	/* frame size = 0 */
 1016               	/* stack size = 0 */
 1017               	.L__stack_usage = 0
 319:keyboards/lily58/ssd1306.c ****   matrix_render(&display);
 1018               		.loc 1 319 0
 1019 0000 80E0      		ldi r24,lo8(display)
 1020 0002 90E0      		ldi r25,hi8(display)
 1021 0004 0C94 0000 		jmp matrix_render
 1022               	.LVL100:
 1023               		.cfi_endproc
 1024               	.LFE131:
 1026               		.section	.text.iota_gfx_init,"ax",@progbits
 1027               	.global	iota_gfx_init
 1029               	iota_gfx_init:
 1030               	.LFB117:
 129:keyboards/lily58/ssd1306.c ****   bool success = false;
 1031               		.loc 1 129 0
 1032               		.cfi_startproc
 1033               	.LVL101:
 1034 0000 CF93      		push r28
 1035               	.LCFI45:
 1036               		.cfi_def_cfa_offset 3
 1037               		.cfi_offset 28, -2
 1038 0002 DF93      		push r29
 1039               	.LCFI46:
 1040               		.cfi_def_cfa_offset 4
 1041               		.cfi_offset 29, -3
 1042               	/* prologue: function */
 1043               	/* frame size = 0 */
 1044               	/* stack size = 2 */
 1045               	.L__stack_usage = 2
 1046 0004 C82F      		mov r28,r24
 1047               	.LVL102:
 132:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayOff);
 1048               		.loc 1 132 0
 1049 0006 0E94 0000 		call i2c_master_init
 1050               	.LVL103:
 133:keyboards/lily58/ssd1306.c ****   send_cmd2(SetDisplayClockDiv, 0x80);
 1051               		.loc 1 133 0
 1052 000a 8EEA      		ldi r24,lo8(-82)
 1053 000c 0E94 0000 		call _send_cmd1
 1054               	.LVL104:
 1055 0010 8111      		cpse r24,__zero_reg__
 1056 0012 00C0      		rjmp .L59
 1057               	.L61:
 130:keyboards/lily58/ssd1306.c **** 
 1058               		.loc 1 130 0
 1059 0014 80E0      		ldi r24,0
 1060 0016 00C0      		rjmp .L60
 1061               	.L59:
 134:keyboards/lily58/ssd1306.c ****   send_cmd2(SetMultiPlex, DisplayHeight - 1);
 1062               		.loc 1 134 0
 1063 0018 60E8      		ldi r22,lo8(-128)
 1064 001a 85ED      		ldi r24,lo8(-43)
 1065 001c 0E94 0000 		call _send_cmd2
 1066               	.LVL105:
 1067 0020 8823      		tst r24
 1068 0022 01F0      		breq .L61
 135:keyboards/lily58/ssd1306.c **** 
 1069               		.loc 1 135 0
 1070 0024 6FE1      		ldi r22,lo8(31)
 1071 0026 88EA      		ldi r24,lo8(-88)
 1072 0028 0E94 0000 		call _send_cmd2
 1073               	.LVL106:
 1074 002c 8823      		tst r24
 1075 002e 01F0      		breq .L61
 137:keyboards/lily58/ssd1306.c **** 
 1076               		.loc 1 137 0
 1077 0030 60E0      		ldi r22,0
 1078 0032 83ED      		ldi r24,lo8(-45)
 1079 0034 0E94 0000 		call _send_cmd2
 1080               	.LVL107:
 1081 0038 8823      		tst r24
 1082 003a 01F0      		breq .L61
 140:keyboards/lily58/ssd1306.c ****   send_cmd2(SetChargePump, 0x14 /* Enable */);
 1083               		.loc 1 140 0
 1084 003c 80E4      		ldi r24,lo8(64)
 1085 003e 0E94 0000 		call _send_cmd1
 1086               	.LVL108:
 1087 0042 8823      		tst r24
 1088 0044 01F0      		breq .L61
 141:keyboards/lily58/ssd1306.c ****   send_cmd2(SetMemoryMode, 0 /* horizontal addressing */);
 1089               		.loc 1 141 0
 1090 0046 64E1      		ldi r22,lo8(20)
 1091 0048 8DE8      		ldi r24,lo8(-115)
 1092 004a 0E94 0000 		call _send_cmd2
 1093               	.LVL109:
 1094 004e 8823      		tst r24
 1095 0050 01F0      		breq .L61
 142:keyboards/lily58/ssd1306.c **** 
 1096               		.loc 1 142 0
 1097 0052 60E0      		ldi r22,0
 1098 0054 80E2      		ldi r24,lo8(32)
 1099 0056 0E94 0000 		call _send_cmd2
 1100               	.LVL110:
 1101 005a 8823      		tst r24
 1102 005c 01F0      		breq .L61
 144:keyboards/lily58/ssd1306.c ****     // the following Flip the display orientation 180 degrees
 1103               		.loc 1 144 0
 1104 005e CC23      		tst r28
 1105 0060 01F0      		breq .L62
 146:keyboards/lily58/ssd1306.c ****     send_cmd1(ComScanInc);
 1106               		.loc 1 146 0
 1107 0062 80EA      		ldi r24,lo8(-96)
 1108 0064 0E94 0000 		call _send_cmd1
 1109               	.LVL111:
 1110 0068 8823      		tst r24
 1111 006a 01F0      		breq .L61
 147:keyboards/lily58/ssd1306.c ****   }else{
 1112               		.loc 1 147 0
 1113 006c 80EC      		ldi r24,lo8(-64)
 1114 006e 00C0      		rjmp .L126
 1115               	.L62:
 150:keyboards/lily58/ssd1306.c ****     send_cmd1(ComScanDec);
 1116               		.loc 1 150 0
 1117 0070 81EA      		ldi r24,lo8(-95)
 1118 0072 0E94 0000 		call _send_cmd1
 1119               	.LVL112:
 1120 0076 8823      		tst r24
 1121 0078 01F0      		breq .L61
 151:keyboards/lily58/ssd1306.c ****   }
 1122               		.loc 1 151 0
 1123 007a 88EC      		ldi r24,lo8(-56)
 1124               	.L126:
 1125 007c 0E94 0000 		call _send_cmd1
 1126               	.LVL113:
 1127 0080 8823      		tst r24
 1128 0082 01F0      		breq .L61
 154:keyboards/lily58/ssd1306.c ****   send_cmd2(SetContrast, 0x8f);
 1129               		.loc 1 154 0
 1130 0084 62E0      		ldi r22,lo8(2)
 1131 0086 8AED      		ldi r24,lo8(-38)
 1132 0088 0E94 0000 		call _send_cmd2
 1133               	.LVL114:
 1134 008c 8823      		tst r24
 1135 008e 01F0      		breq .L61
 155:keyboards/lily58/ssd1306.c ****   send_cmd2(SetPreCharge, 0xf1);
 1136               		.loc 1 155 0
 1137 0090 6FE8      		ldi r22,lo8(-113)
 1138 0092 81E8      		ldi r24,lo8(-127)
 1139 0094 0E94 0000 		call _send_cmd2
 1140               	.LVL115:
 1141 0098 8823      		tst r24
 1142 009a 01F4      		brne .+2
 1143 009c 00C0      		rjmp .L61
 156:keyboards/lily58/ssd1306.c ****   send_cmd2(SetVComDetect, 0x40);
 1144               		.loc 1 156 0
 1145 009e 61EF      		ldi r22,lo8(-15)
 1146 00a0 89ED      		ldi r24,lo8(-39)
 1147 00a2 0E94 0000 		call _send_cmd2
 1148               	.LVL116:
 1149 00a6 8823      		tst r24
 1150 00a8 01F4      		brne .+2
 1151 00aa 00C0      		rjmp .L61
 157:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayAllOnResume);
 1152               		.loc 1 157 0
 1153 00ac 60E4      		ldi r22,lo8(64)
 1154 00ae 8BED      		ldi r24,lo8(-37)
 1155 00b0 0E94 0000 		call _send_cmd2
 1156               	.LVL117:
 1157 00b4 8823      		tst r24
 1158 00b6 01F4      		brne .+2
 1159 00b8 00C0      		rjmp .L61
 158:keyboards/lily58/ssd1306.c ****   send_cmd1(NormalDisplay);
 1160               		.loc 1 158 0
 1161 00ba 84EA      		ldi r24,lo8(-92)
 1162 00bc 0E94 0000 		call _send_cmd1
 1163               	.LVL118:
 1164 00c0 8823      		tst r24
 1165 00c2 01F4      		brne .+2
 1166 00c4 00C0      		rjmp .L61
 159:keyboards/lily58/ssd1306.c ****   send_cmd1(DeActivateScroll);
 1167               		.loc 1 159 0
 1168 00c6 86EA      		ldi r24,lo8(-90)
 1169 00c8 0E94 0000 		call _send_cmd1
 1170               	.LVL119:
 1171 00cc 8823      		tst r24
 1172 00ce 01F4      		brne .+2
 1173 00d0 00C0      		rjmp .L61
 160:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayOn);
 1174               		.loc 1 160 0
 1175 00d2 8EE2      		ldi r24,lo8(46)
 1176 00d4 0E94 0000 		call _send_cmd1
 1177               	.LVL120:
 1178 00d8 8823      		tst r24
 1179 00da 01F4      		brne .+2
 1180 00dc 00C0      		rjmp .L61
 161:keyboards/lily58/ssd1306.c **** 
 1181               		.loc 1 161 0
 1182 00de 8FEA      		ldi r24,lo8(-81)
 1183 00e0 0E94 0000 		call _send_cmd1
 1184               	.LVL121:
 1185 00e4 8823      		tst r24
 1186 00e6 01F4      		brne .+2
 1187 00e8 00C0      		rjmp .L61
 163:keyboards/lily58/ssd1306.c **** 
 1188               		.loc 1 163 0
 1189 00ea 60E0      		ldi r22,0
 1190 00ec 81E8      		ldi r24,lo8(-127)
 1191 00ee 0E94 0000 		call _send_cmd2
 1192               	.LVL122:
 1193 00f2 8823      		tst r24
 1194 00f4 01F4      		brne .+2
 1195 00f6 00C0      		rjmp .L61
 1196               	.LBB37:
 1197               	.LBB38:
  90:keyboards/lily58/ssd1306.c **** 
 1198               		.loc 1 90 0
 1199 00f8 80E0      		ldi r24,lo8(display)
 1200 00fa 90E0      		ldi r25,hi8(display)
 1201 00fc 0E94 0000 		call matrix_clear
 1202               	.LVL123:
  94:keyboards/lily58/ssd1306.c ****   send_cmd3(ColumnAddr, 0, DisplayWidth - 1);
 1203               		.loc 1 94 0
 1204 0100 63E0      		ldi r22,lo8(3)
 1205 0102 82E2      		ldi r24,lo8(34)
 1206 0104 0E94 0000 		call _send_cmd3.constprop.1
 1207               	.LVL124:
 1208 0108 8823      		tst r24
 1209 010a 01F0      		breq .L66
  95:keyboards/lily58/ssd1306.c **** 
 1210               		.loc 1 95 0
 1211 010c 6FE7      		ldi r22,lo8(127)
 1212 010e 81E2      		ldi r24,lo8(33)
 1213 0110 0E94 0000 		call _send_cmd3.constprop.1
 1214               	.LVL125:
 1215 0114 8823      		tst r24
 1216 0116 01F0      		breq .L66
 1217               	.LVL126:
 1218               	.LBB39:
 1219               	.LBB40:
 1220               		.loc 2 36 0
 1221 0118 88E7      		ldi r24,lo8(120)
 1222 011a 0E94 0000 		call i2c_master_start
 1223               	.LVL127:
 1224               	.LBE40:
 1225               	.LBE39:
  97:keyboards/lily58/ssd1306.c ****     goto done;
 1226               		.loc 1 97 0
 1227 011e 8111      		cpse r24,__zero_reg__
 1228 0120 00C0      		rjmp .L66
 100:keyboards/lily58/ssd1306.c ****     // Data mode
 1229               		.loc 1 100 0
 1230 0122 80E4      		ldi r24,lo8(64)
 1231 0124 0E94 0000 		call i2c_master_write
 1232               	.LVL128:
 1233 0128 8111      		cpse r24,__zero_reg__
 1234 012a 00C0      		rjmp .L66
 1235 012c D4E0      		ldi r29,lo8(4)
 1236               	.LVL129:
 1237               	.L68:
 1238               	.LBE38:
 1239               	.LBE37:
 129:keyboards/lily58/ssd1306.c ****   bool success = false;
 1240               		.loc 1 129 0
 1241 012e C0E0      		ldi r28,0
 1242               	.LVL130:
 1243               	.L69:
 1244               	.LBB44:
 1245               	.LBB43:
 1246               	.LBB41:
 1247               	.LBB42:
 106:keyboards/lily58/ssd1306.c ****     }
 1248               		.loc 1 106 0
 1249 0130 80E0      		ldi r24,0
 1250 0132 0E94 0000 		call i2c_master_write
 1251               	.LVL131:
 105:keyboards/lily58/ssd1306.c ****       i2c_master_write(0);
 1252               		.loc 1 105 0
 1253 0136 CF5F      		subi r28,lo8(-(1))
 1254               	.LVL132:
 1255 0138 C038      		cpi r28,lo8(-128)
 1256 013a 01F4      		brne .L69
 1257               	.LVL133:
 1258 013c D150      		subi r29,lo8(-(-1))
 1259               	.LVL134:
 1260               	.LBE42:
 104:keyboards/lily58/ssd1306.c ****     for (uint8_t col = 0; col < DisplayWidth; ++col) {
 1261               		.loc 1 104 0
 1262 013e 01F4      		brne .L68
 1263               	.LBE41:
 110:keyboards/lily58/ssd1306.c **** 
 1264               		.loc 1 110 0
 1265 0140 1092 0000 		sts display+86,__zero_reg__
 1266               	.LVL135:
 1267               	.L66:
 113:keyboards/lily58/ssd1306.c **** }
 1268               		.loc 1 113 0
 1269 0144 0E94 0000 		call i2c_master_stop
 1270               	.LVL136:
 1271               	.LBE43:
 1272               	.LBE44:
 169:keyboards/lily58/ssd1306.c **** 
 1273               		.loc 1 169 0
 1274 0148 0E94 0000 		call iota_gfx_flush
 1275               	.LVL137:
 167:keyboards/lily58/ssd1306.c **** 
 1276               		.loc 1 167 0
 1277 014c 81E0      		ldi r24,lo8(1)
 1278               	.LVL138:
 1279               	.L60:
 1280               	/* epilogue start */
 177:keyboards/lily58/ssd1306.c **** 
 1281               		.loc 1 177 0
 1282 014e DF91      		pop r29
 1283 0150 CF91      		pop r28
 1284 0152 0895      		ret
 1285               		.cfi_endproc
 1286               	.LFE117:
 1288               		.section	.text.iota_gfx_task_user,"ax",@progbits
 1289               		.weak	iota_gfx_task_user
 1291               	iota_gfx_task_user:
 1292               	.LFB132:
 320:keyboards/lily58/ssd1306.c **** }
 321:keyboards/lily58/ssd1306.c **** 
 322:keyboards/lily58/ssd1306.c **** __attribute__ ((weak))
 323:keyboards/lily58/ssd1306.c **** void iota_gfx_task_user(void) {
 1293               		.loc 1 323 0
 1294               		.cfi_startproc
 1295               	/* prologue: function */
 1296               	/* frame size = 0 */
 1297               	/* stack size = 0 */
 1298               	.L__stack_usage = 0
 1299 0000 0895      		ret
 1300               		.cfi_endproc
 1301               	.LFE132:
 1303               		.section	.text.iota_gfx_task,"ax",@progbits
 1304               	.global	iota_gfx_task
 1306               	iota_gfx_task:
 1307               	.LFB133:
 324:keyboards/lily58/ssd1306.c **** }
 325:keyboards/lily58/ssd1306.c **** 
 326:keyboards/lily58/ssd1306.c **** void iota_gfx_task(void) {
 1308               		.loc 1 326 0
 1309               		.cfi_startproc
 1310               	/* prologue: function */
 1311               	/* frame size = 0 */
 1312               	/* stack size = 0 */
 1313               	.L__stack_usage = 0
 327:keyboards/lily58/ssd1306.c ****   iota_gfx_task_user();
 1314               		.loc 1 327 0
 1315 0000 0E94 0000 		call iota_gfx_task_user
 1316               	.LVL139:
 328:keyboards/lily58/ssd1306.c **** 
 329:keyboards/lily58/ssd1306.c ****   if (display.dirty|| force_dirty) {
 1317               		.loc 1 329 0
 1318 0004 8091 0000 		lds r24,display+86
 1319 0008 8111      		cpse r24,__zero_reg__
 1320 000a 00C0      		rjmp .L129
 1321               		.loc 1 329 0 is_stmt 0 discriminator 1
 1322 000c 8091 0000 		lds r24,force_dirty
 1323 0010 8823      		tst r24
 1324 0012 01F0      		breq .L130
 1325               	.L129:
 330:keyboards/lily58/ssd1306.c ****     iota_gfx_flush();
 1326               		.loc 1 330 0 is_stmt 1
 1327 0014 0E94 0000 		call iota_gfx_flush
 1328               	.LVL140:
 331:keyboards/lily58/ssd1306.c ****     force_dirty = false;
 1329               		.loc 1 331 0
 1330 0018 1092 0000 		sts force_dirty,__zero_reg__
 1331               	.L130:
 332:keyboards/lily58/ssd1306.c ****   }
 333:keyboards/lily58/ssd1306.c **** 
 334:keyboards/lily58/ssd1306.c ****   if (timer_elapsed(last_flush) > ScreenOffInterval) {
 1332               		.loc 1 334 0
 1333 001c 8091 0000 		lds r24,last_flush
 1334 0020 9091 0000 		lds r25,last_flush+1
 1335 0024 0E94 0000 		call timer_elapsed
 1336               	.LVL141:
 1337 0028 8136      		cpi r24,97
 1338 002a 9A4E      		sbci r25,-22
 1339 002c 00F0      		brlo .L128
 335:keyboards/lily58/ssd1306.c ****     iota_gfx_off();
 1340               		.loc 1 335 0
 1341 002e 0C94 0000 		jmp iota_gfx_off
 1342               	.LVL142:
 1343               	.L128:
 1344 0032 0895      		ret
 1345               		.cfi_endproc
 1346               	.LFE133:
 1348               		.section	.text.process_record_gfx,"ax",@progbits
 1349               	.global	process_record_gfx
 1351               	process_record_gfx:
 1352               	.LFB134:
 336:keyboards/lily58/ssd1306.c ****   }
 337:keyboards/lily58/ssd1306.c **** }
 338:keyboards/lily58/ssd1306.c **** 
 339:keyboards/lily58/ssd1306.c **** bool process_record_gfx(uint16_t keycode, keyrecord_t *record) {
 1353               		.loc 1 339 0
 1354               		.cfi_startproc
 1355               	.LVL143:
 1356               	/* prologue: function */
 1357               	/* frame size = 0 */
 1358               	/* stack size = 0 */
 1359               	.L__stack_usage = 0
 340:keyboards/lily58/ssd1306.c ****   force_dirty = true;
 1360               		.loc 1 340 0
 1361 0000 81E0      		ldi r24,lo8(1)
 1362               	.LVL144:
 1363 0002 8093 0000 		sts force_dirty,r24
 341:keyboards/lily58/ssd1306.c ****   return true;
 342:keyboards/lily58/ssd1306.c **** }
 1364               		.loc 1 342 0
 1365 0006 0895      		ret
 1366               		.cfi_endproc
 1367               	.LFE134:
 1369               		.section	.data.force_dirty,"aw",@progbits
 1372               	force_dirty:
 1373 0000 01        		.byte	1
 1374               		.section	.bss.last_flush,"aw",@nobits
 1377               	last_flush:
 1378 0000 0000      		.zero	2
 1379               		.comm	display,87,1
 1380               		.text
 1381               	.Letext0:
 1382               		.file 3 "/usr/lib/avr/include/stdint.h"
 1383               		.file 4 "/usr/lib/gcc/avr/4.9.2/include/stddef.h"
 1384               		.file 5 "tmk_core/common/keyboard.h"
 1385               		.file 6 "tmk_core/common/action.h"
 1386               		.file 7 "keyboards/lily58/ssd1306.h"
 1387               		.file 8 "lib/lufa/LUFA/Drivers/USB/Core/USBTask.h"
 1388               		.file 9 "/usr/lib/avr/include/string.h"
 1389               		.file 10 "/usr/lib/avr/include/stdio.h"
 1390               		.file 11 "tmk_core/common/timer.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 ssd1306.c
     /tmp/cct4UCld.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/cct4UCld.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/cct4UCld.s:4      *ABS*:000000000000003f __SREG__
     /tmp/cct4UCld.s:5      *ABS*:0000000000000000 __tmp_reg__
     /tmp/cct4UCld.s:6      *ABS*:0000000000000001 __zero_reg__
     /tmp/cct4UCld.s:12     .text._send_cmd1:0000000000000000 _send_cmd1
     /tmp/cct4UCld.s:72     .text._send_cmd2:0000000000000000 _send_cmd2
     /tmp/cct4UCld.s:126    .text._send_cmd3.constprop.1:0000000000000000 _send_cmd3.constprop.1
     /tmp/cct4UCld.s:183    .text.iota_gfx_off:0000000000000000 iota_gfx_off
     /tmp/cct4UCld.s:202    .text.iota_gfx_on:0000000000000000 iota_gfx_on
     /tmp/cct4UCld.s:221    .text.matrix_write_char_inner:0000000000000000 matrix_write_char_inner
     /tmp/cct4UCld.s:314    .text.matrix_write_char:0000000000000000 matrix_write_char
     /tmp/cct4UCld.s:398    .text.iota_gfx_write_char:0000000000000000 iota_gfx_write_char
                            *COM*:0000000000000057 display
     /tmp/cct4UCld.s:420    .text.matrix_write:0000000000000000 matrix_write
     /tmp/cct4UCld.s:499    .text.matrix_write_ln:0000000000000000 matrix_write_ln
     /tmp/cct4UCld.s:625    .text.iota_gfx_write:0000000000000000 iota_gfx_write
     /tmp/cct4UCld.s:647    .text.matrix_write_P:0000000000000000 matrix_write_P
     /tmp/cct4UCld.s:718    .text.iota_gfx_write_P:0000000000000000 iota_gfx_write_P
     /tmp/cct4UCld.s:740    .text.matrix_clear:0000000000000000 matrix_clear
     /tmp/cct4UCld.s:788    .text.iota_gfx_clear_screen:0000000000000000 iota_gfx_clear_screen
     /tmp/cct4UCld.s:807    .text.matrix_render:0000000000000000 matrix_render
     /tmp/cct4UCld.s:1377   .bss.last_flush:0000000000000000 last_flush
     /tmp/cct4UCld.s:1010   .text.iota_gfx_flush:0000000000000000 iota_gfx_flush
     /tmp/cct4UCld.s:1029   .text.iota_gfx_init:0000000000000000 iota_gfx_init
     /tmp/cct4UCld.s:1291   .text.iota_gfx_task_user:0000000000000000 iota_gfx_task_user
     /tmp/cct4UCld.s:1306   .text.iota_gfx_task:0000000000000000 iota_gfx_task
     /tmp/cct4UCld.s:1372   .data.force_dirty:0000000000000000 force_dirty
     /tmp/cct4UCld.s:1351   .text.process_record_gfx:0000000000000000 process_record_gfx

UNDEFINED SYMBOLS
i2c_master_start
i2c_master_write
i2c_master_stop
memmove
memset
__divmodhi4
snprintf
timer_read
font
i2c_master_init
timer_elapsed
__do_copy_data
__do_clear_bss
